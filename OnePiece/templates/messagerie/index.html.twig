{% extends 'base.html.twig' %}

{% block title %}Messagerie{% endblock %}

{% block stylesheets %}
<style>
    .conversation-list, .user-list {
        list-style: none;
        padding: 0;
    }
    .navbar-gradient {
        background: linear-gradient(90deg, #0c0d0eff, #004aad);
        color: white;
    }
     @keyframes gradientShift {
      0%{background-position:0% 50%;}
      50%{background-position:100% 50%;}
      100%{background-position:0% 50%;}
    }

    /* Animation navbar apparition */
    nav.navbar {
      transform: translateY(-100%);
      opacity: 0;
      animation: slideFadeIn 0.7s forwards;
    }
    @keyframes slideFadeIn {
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    /* Nav link style */
    .navbar-nav .nav-link {
      position: relative;
      transition: color 0.3s ease;
      font-weight: 500;
      color: #e0e0e0; /* Couleur neutre clair pour liens inactifs */
    }

    /* Liens actifs et hover en bleu bootstrap */
    .navbar-nav .nav-link.active,
    .navbar-nav .nav-link:hover,
    .navbar-nav .nav-link:focus {
      color: #0d6efd !important;
    }

    /* Underline effect in blue */
    .navbar-nav .nav-link::after {
      content: "";
      position: absolute;
      width: 0%;
      height: 2px;
      bottom: 0;
      left: 0;
      background-color: #0d6efd;
      transition: width 0.3s ease;
      border-radius: 1px;
    }
    .navbar-nav .nav-link:hover::after,
    .navbar-nav .nav-link.active::after {
      width: 100%;
    }

    /* Dropdown fade */
    .dropdown-menu {
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.3s ease, transform 0.3s ease;
      pointer-events: none;
    }
    .dropdown.show .dropdown-menu {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }

    /* Brand style */
    .navbar-brand {
      font-weight: 700;
      font-size: 1.8rem;
      letter-spacing: 1.2px;
      color: #fff !important;
      text-shadow: 0 0 5px rgba(0,0,0,0.3);
      transition: color 0.3s ease;
    }
    .navbar-brand:hover {
      color: #0d6efd !important; /* bleu au hover aussi */
    }

    /* Toggler icon animation */
    .navbar-toggler {
      border: none;
      outline: none;
      transition: transform 0.3s ease;
    }
    .navbar-toggler:focus {
      box-shadow: none;
    }
    .navbar-toggler.collapsed:hover {
      transform: rotate(90deg);
    }

    /* Adjust dropdown caret icon */
    .nav-link.dropdown-toggle::after {
      margin-left: 5px;
      transition: transform 0.3s ease;
      border-top: 0.3em solid;
      border-right: 0.3em solid transparent;
      border-left: 0.3em solid transparent;
      content: "";
      display: inline-block;
      vertical-align: middle;
    }
    .nav-item.show > .nav-link.dropdown-toggle::after {
      transform: rotate(180deg);
    }

    .conversation-list li,
    .user-list li {
        margin: 10px 0;
        padding: 10px;
        border-radius: 8px;
        transition: background-color 0.3s ease;
        display: flex;
        align-items: center;
        gap: 10px;
        background-color: #f7f7f7;
    }

    .conversation-list li:hover,
    .user-list li:hover {
        background-color: #e6f7ff;
    }

    .user-avatar {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        object-fit: cover;
        border: 1px solid #ccc;
    }

    .conversation-info {
        display: flex;
        flex-direction: column;
    }

    .last-message-date {
        font-size: 0.85em;
        color: #888;
    }

</style>
{% endblock %}

{% block body %}
<h1>ðŸ“¨ Vos conversations</h1>

<ul class="conversation-list">
    {% for conv in conversations %}
        <li>
            <a href="{{ path('messagerie_conversation', {id: conv.id}) }}">
                <div class="conversation-info">
                    <strong>{{ conv.Prenoms }} {{ conv.Nom }}</strong>
                    <span class="last-message-date">Dernier message : {{ conv.lastMessageDate|date('d/m/Y H:i') }}</span>
                </div>
            </a>
        </li>
    {% else %}
        <li>Aucune conversation pour lâ€™instant.</li>
    {% endfor %}
</ul>

<hr>

<h2>ðŸ‘¥ Utilisateurs disponibles</h2>
<ul class="user-list">
    {% for user in utilisateurs %}
        <li>
            <img 
                src="{{ asset('uploads/profile_photos/default_avatar.png') }}" 
                alt="Photo de {{ user.Prenoms }}" 
                width="40" height="40" 
                style="border-radius: 50%; object-fit: cover;"
            >

            <a href="{{ path('messagerie_conversation', {id: user.id}) }}">
                {{ user.Prenoms }} {{ user.Nom }}
            </a>
        </li>
    {% endfor %}
</ul>
{% endblock %}
