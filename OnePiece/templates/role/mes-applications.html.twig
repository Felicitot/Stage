{# templates/role/mes-applications.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Mes Applications{% endblock %}

{% block stylesheets %}
<style>
  #appList li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: background-color 0.3s ease, transform 0.4s ease, opacity 0.4s ease;
    opacity: 0;
    transform: translateY(10px);
    margin-bottom: 0.5rem;
    padding: 1rem;
  }
  .navbar-gradient {
        background: linear-gradient(90deg, #0c0d0eff, #004aad);
        color: white;
  }
   @keyframes gradientShift {
      0%{background-position:0% 50%;}
      50%{background-position:100% 50%;}
      100%{background-position:0% 50%;}
    }

    /* Animation navbar apparition */
    nav.navbar {
      transform: translateY(-100%);
      opacity: 0;
      animation: slideFadeIn 0.7s forwards;
    }
    @keyframes slideFadeIn {
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    /* Nav link style */
    .navbar-nav .nav-link {
      position: relative;
      transition: color 0.3s ease;
      font-weight: 500;
      color: #e0e0e0; /* Couleur neutre clair pour liens inactifs */
    }

    /* Liens actifs et hover en bleu bootstrap */
    .navbar-nav .nav-link.active,
    .navbar-nav .nav-link:hover,
    .navbar-nav .nav-link:focus {
      color: #0d6efd !important;
    }

    /* Underline effect in blue */
    .navbar-nav .nav-link::after {
      content: "";
      position: absolute;
      width: 0%;
      height: 2px;
      bottom: 0;
      left: 0;
      background-color: #0d6efd;
      transition: width 0.3s ease;
      border-radius: 1px;
    }
    .navbar-nav .nav-link:hover::after,
    .navbar-nav .nav-link.active::after {
      width: 100%;
    }

    /* Dropdown fade */
    .dropdown-menu {
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.3s ease, transform 0.3s ease;
      pointer-events: none;
    }
    .dropdown.show .dropdown-menu {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }

    /* Brand style */
    .navbar-brand {
      font-weight: 700;
      font-size: 1.8rem;
      letter-spacing: 1.2px;
      color: #fff !important;
      text-shadow: 0 0 5px rgba(0,0,0,0.3);
      transition: color 0.3s ease;
    }
    .navbar-brand:hover {
      color: #0d6efd !important; /* bleu au hover aussi */
    }

    /* Toggler icon animation */
    .navbar-toggler {
      border: none;
      outline: none;
      transition: transform 0.3s ease;
    }
    .navbar-toggler:focus {
      box-shadow: none;
    }
    .navbar-toggler.collapsed:hover {
      transform: rotate(90deg);
    }

    /* Adjust dropdown caret icon */
    .nav-link.dropdown-toggle::after {
      margin-left: 5px;
      transition: transform 0.3s ease;
      border-top: 0.3em solid;
      border-right: 0.3em solid transparent;
      border-left: 0.3em solid transparent;
      content: "";
      display: inline-block;
      vertical-align: middle;
    }
    .nav-item.show > .nav-link.dropdown-toggle::after {
      transform: rotate(180deg);
    }
  #appList li.visible {
    opacity: 1;
    transform: translateY(0);
  }
  #appList li:hover {
    background-color: #e6f0ff;
  }
  /* Contenu à gauche */
  .app-details {
    max-width: 80%;
  }
  .app-details strong,
  .app-details small,
  .app-details a {
    display: block;
  }
</style>
{% endblock %}

{% block body %}
<div class="container mt-4">
    <h2>Applications accessibles selon vos rôles</h2>

    <input type="text" id="searchApp" class="form-control mb-3" placeholder="Rechercher une application...">

    {% if applications is empty %}
        <p>Aucune application accessible.</p>
    {% else %}
        <ul id="appList" class="list-group">
            {% for app in applications %}
                <li class="list-group-item">
                    <div class="app-details">
                        <strong>{{ app.nomAppli }}</strong>
                        <a href="{{ app.url }}" target="_blank" rel="noopener noreferrer">{{ app.url }}</a>
                        <small>{{ app.description }}</small>
                    </div>
                    <a href="{{ path('sso_redirect', {id: app.id}) }}" >
                        Accéder<img 
                src="{{ asset('uploads/profile_photos/applications.png') }}" 
                width="40" height="40" 
                style="border-radius: 50%; object-fit: cover;"
            >
                    </a>
                </li>
            {% endfor %}
        </ul>
    {% endif %}
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const items = document.querySelectorAll('#appList li');
    items.forEach((item, index) => {
      setTimeout(() => item.classList.add('visible'), index * 100);
    });
  });

  document.getElementById('searchApp').addEventListener('input', function() {
      const filter = this.value.toLowerCase();
      const apps = document.querySelectorAll('#appList li');
      apps.forEach(app => {
          const text = app.textContent.toLowerCase();
          if (text.includes(filter)) {
            app.style.display = '';
            setTimeout(() => app.classList.add('visible'), 0);
          } else {
            app.style.display = 'none';
            app.classList.remove('visible');
          }
      });
  });
</script>
{% endblock %}
